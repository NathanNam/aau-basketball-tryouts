import {
  OTLPExporterBase,
  ProtobufMetricsSerializer,
  createLegacyOtlpBrowserExportDelegate
} from "./chunk-COTH2NMS.js";
import {
  AggregationTemporality,
  AggregationType,
  InstrumentType
} from "./chunk-3QLT7M6V.js";
import {
  getStringFromEnv
} from "./chunk-MUUYURUO.js";
import "./chunk-JOJVESY7.js";
import {
  diag
} from "./chunk-WWXHSA53.js";
import "./chunk-G3PMV62Z.js";

// node_modules/.pnpm/@opentelemetry+exporter-metrics-otlp-http@0.208.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/exporter-metrics-otlp-http/build/esm/OTLPMetricExporterOptions.js
var AggregationTemporalityPreference;
(function(AggregationTemporalityPreference2) {
  AggregationTemporalityPreference2[AggregationTemporalityPreference2["DELTA"] = 0] = "DELTA";
  AggregationTemporalityPreference2[AggregationTemporalityPreference2["CUMULATIVE"] = 1] = "CUMULATIVE";
  AggregationTemporalityPreference2[AggregationTemporalityPreference2["LOWMEMORY"] = 2] = "LOWMEMORY";
})(AggregationTemporalityPreference || (AggregationTemporalityPreference = {}));

// node_modules/.pnpm/@opentelemetry+exporter-metrics-otlp-http@0.208.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/exporter-metrics-otlp-http/build/esm/OTLPMetricExporterBase.js
var CumulativeTemporalitySelector = () => AggregationTemporality.CUMULATIVE;
var DeltaTemporalitySelector = (instrumentType) => {
  switch (instrumentType) {
    case InstrumentType.COUNTER:
    case InstrumentType.OBSERVABLE_COUNTER:
    case InstrumentType.GAUGE:
    case InstrumentType.HISTOGRAM:
    case InstrumentType.OBSERVABLE_GAUGE:
      return AggregationTemporality.DELTA;
    case InstrumentType.UP_DOWN_COUNTER:
    case InstrumentType.OBSERVABLE_UP_DOWN_COUNTER:
      return AggregationTemporality.CUMULATIVE;
  }
};
var LowMemoryTemporalitySelector = (instrumentType) => {
  switch (instrumentType) {
    case InstrumentType.COUNTER:
    case InstrumentType.HISTOGRAM:
      return AggregationTemporality.DELTA;
    case InstrumentType.GAUGE:
    case InstrumentType.UP_DOWN_COUNTER:
    case InstrumentType.OBSERVABLE_UP_DOWN_COUNTER:
    case InstrumentType.OBSERVABLE_COUNTER:
    case InstrumentType.OBSERVABLE_GAUGE:
      return AggregationTemporality.CUMULATIVE;
  }
};
function chooseTemporalitySelectorFromEnvironment() {
  const configuredTemporality = (getStringFromEnv("OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE") ?? "cumulative").toLowerCase();
  if (configuredTemporality === "cumulative") {
    return CumulativeTemporalitySelector;
  }
  if (configuredTemporality === "delta") {
    return DeltaTemporalitySelector;
  }
  if (configuredTemporality === "lowmemory") {
    return LowMemoryTemporalitySelector;
  }
  diag.warn(`OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE is set to '${configuredTemporality}', but only 'cumulative' and 'delta' are allowed. Using default ('cumulative') instead.`);
  return CumulativeTemporalitySelector;
}
function chooseTemporalitySelector(temporalityPreference) {
  if (temporalityPreference != null) {
    if (temporalityPreference === AggregationTemporalityPreference.DELTA) {
      return DeltaTemporalitySelector;
    } else if (temporalityPreference === AggregationTemporalityPreference.LOWMEMORY) {
      return LowMemoryTemporalitySelector;
    }
    return CumulativeTemporalitySelector;
  }
  return chooseTemporalitySelectorFromEnvironment();
}
var DEFAULT_AGGREGATION = Object.freeze({
  type: AggregationType.DEFAULT
});
function chooseAggregationSelector(config) {
  return config?.aggregationPreference ?? (() => DEFAULT_AGGREGATION);
}
var OTLPMetricExporterBase = class extends OTLPExporterBase {
  _aggregationTemporalitySelector;
  _aggregationSelector;
  constructor(delegate, config) {
    super(delegate);
    this._aggregationSelector = chooseAggregationSelector(config);
    this._aggregationTemporalitySelector = chooseTemporalitySelector(config?.temporalityPreference);
  }
  selectAggregation(instrumentType) {
    return this._aggregationSelector(instrumentType);
  }
  selectAggregationTemporality(instrumentType) {
    return this._aggregationTemporalitySelector(instrumentType);
  }
};

// node_modules/.pnpm/@opentelemetry+exporter-metrics-otlp-proto@0.208.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/exporter-metrics-otlp-proto/build/esm/platform/browser/OTLPMetricExporter.js
var OTLPMetricExporter2 = class extends OTLPMetricExporterBase {
  constructor(config = {}) {
    super(createLegacyOtlpBrowserExportDelegate(config, ProtobufMetricsSerializer, "v1/metrics", { "Content-Type": "application/x-protobuf" }), config);
  }
};
export {
  OTLPMetricExporter2 as OTLPMetricExporter
};
//# sourceMappingURL=@opentelemetry_exporter-metrics-otlp-proto.js.map
