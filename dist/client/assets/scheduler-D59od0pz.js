import{r,j as e}from"./main-CHgcn4R6.js";function u(){const[s,m]=r.useState(null),[d,i]=r.useState(!1),[o,x]=r.useState(!1),[c,l]=r.useState(null),n=async()=>{i(!0);try{const a=await(await fetch("/api/scheduler/status")).json();m(a)}catch(t){console.error("Failed to fetch status:",t),l("Failed to load scheduler status")}finally{i(!1)}},h=async()=>{x(!0),l(null);try{const a=await(await fetch("/api/scheduler/check")).json();l(a.success?`✅ ${a.message}`:`❌ Check failed: ${a.message}`),await n()}catch(t){console.error("Failed to trigger check:",t),l("❌ Failed to trigger check")}finally{x(!1)}};return r.useState(()=>{n()}),e.jsx("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Scheduler Dashboard"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:n,disabled:d,className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 disabled:opacity-50",children:d?"Loading...":"Refresh Status"}),e.jsx("button",{onClick:h,disabled:o,className:"px-4 py-2 bg-primary text-white rounded hover:bg-primary-600 disabled:opacity-50",children:o?"Checking...":"Run Check Now"})]})]}),c&&e.jsx("div",{className:`mb-6 p-4 rounded ${c.startsWith("✅")?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:c}),s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Scheduler Status"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"border rounded p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Status"}),e.jsx("div",{className:"text-lg font-semibold",children:s.scheduler.enabled?e.jsx("span",{className:"text-green-600",children:"✓ Enabled"}):e.jsx("span",{className:"text-gray-500",children:"Disabled (Dev Mode)"})})]}),e.jsxs("div",{className:"border rounded p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Running"}),e.jsx("div",{className:"text-lg font-semibold",children:s.scheduler.running?e.jsx("span",{className:"text-green-600",children:"Yes"}):e.jsx("span",{className:"text-gray-500",children:"No"})})]}),e.jsxs("div",{className:"border rounded p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Schedule"}),e.jsx("div",{className:"text-lg font-semibold",children:s.scheduler.schedule}),e.jsx("div",{className:"text-xs text-gray-500",children:"Daily at 9 AM PT"})]}),e.jsxs("div",{className:"border rounded p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Next Run"}),e.jsx("div",{className:"text-lg font-semibold",children:s.scheduler.nextRun||"N/A"})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Summary"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"border rounded p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Checks"}),e.jsx("div",{className:"text-2xl font-bold",children:s.summary.totalChecks})]}),e.jsxs("div",{className:"border rounded p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Last Check"}),e.jsx("div",{className:"text-sm font-semibold",children:s.summary.lastCheck?new Date(s.summary.lastCheck).toLocaleString():"Never"})]}),e.jsxs("div",{className:"border rounded p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Recent Changes"}),e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:s.summary.recentChanges.length})]})]})]}),s.summary.recentChanges.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Recent Changes"}),e.jsx("div",{className:"space-y-3",children:s.summary.recentChanges.map(t=>e.jsxs("div",{className:"border-l-4 border-orange-500 bg-orange-50 p-4 rounded",children:[e.jsx("div",{className:"font-semibold text-gray-900",children:t.organizationName}),e.jsx("div",{className:"text-sm text-gray-600",children:t.website}),t.foundPatterns.length>0&&e.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Found: ",t.foundPatterns.join(", ")]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Last checked: ",new Date(t.lastChecked).toLocaleString()]})]},t.organizationName))})]})]}),!s&&!d&&e.jsx("div",{className:"text-center text-gray-500 py-8",children:'Click "Refresh Status" to load scheduler information'})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("a",{href:"/",className:"text-primary hover:text-primary-600 font-medium",children:"← Back to Tryouts"})})]})})}export{u as component};
